{% extends "base.html" %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet"
              href="https://tools-static.wmflabs.org/cdnjs/ajax/libs/datatables/1.10.16/css/dataTables.bootstrap4.min.css">
    <script src="https://tools-static.wmflabs.org/cdnjs/ajax/libs/datatables/1.10.16/js/jquery.dataTables.min.js"></script>

    <script>
        $( document ).ready( function(){
            $('.user-pages').on( 'click', function(){
                $(this).next().toggle();
            });

            $('.statsTable').DataTable({
                paging: false,
                searching: false,
                lengthChange: false,
                bInfo : false
            });
        });
    </script>
    <style>
        .user-pages {
            text-decoration: underline;
            color: #007bff;
            cursor: pointer;
        }
    </style>
{% endblock %}

{% block main %}
    <h1>Contest Info</h1>
    <hr>
    {% if logged %}
        {% if username in data["admin"] %}
            <a class="float-right btn btn-info" href="{{ request.url + '/edit' }}">Edit Contest</a>
        {% endif %}
    {% endif %}
    <ul>
        <li>
            Name: {{ data["name"] }}
        </li>
        <li>
            Project: {{ data["project"] }}
        </li>
        <li>
            Started from: {{ data["start_date"] }}
        </li>
        <li>
            End on: {{ data["end_date"] }}
        </li>
        <li>
            Created by: {{ data["createdby"] }}
        </li>
        <li>
            Created on: {{ data["createdon"] }} UTC
        </li>
        <li>
            Last Update: {{ lastUpdate }}
        </li>

    </ul>
    <h2>Administrators</h2>
    <hr>
    <ol>
        {% for u in data["admin"] %}
            <li>
                <a href="https://{{data["project"]}}.wikisource.org/wiki/User:{{ u }}">
                    {{ u }}
                </a>
            </li>
        {% endfor %}
    </ol>

    <h2>Index Page</h2>
    <hr>
    <ol>
        {% for u in data["index"] %}
            <li>
                <a href="https://{{data["project"]}}.wikisource.org/wiki/{{ u }}">
                    {{ u }}
                </a>
            </li>
        {% endfor %}
    </ol>

    <h2>Scores</h2>
    <h5>Proofread</h5>
    <hr>
    <table class="statsTable table table-hover table-bordered">
        <thead>
            <tr>
                <th>User</th>
                <th>Pages</th>
                <th>No of Pages</th>
            </tr>
        </thead>
        <tbody>
            {% for users in proofread %}
            <tr>
                <td>
                    <a href="https://{{data["project"]}}.wikisource.org/wiki/User:{{users}}">
                        {{users}}
                    </a>
                </td>
                <td>
                    <p class="user-pages"> Show/Hide Pages </p>
                    <div style="display:none;">
                        {% for page in proofread[users] %}
                            <a href="https://{{ data["project"] }}.wikisource.org/wiki/{{page}}">
                                {{page}}
                            </a>
                            <br>
                        {% endfor %}
                    </div>
                </td>
                <td>{{ proofread[users]|length }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <br>
    <h5>Validate</h5>
    <hr>
    <table class="statsTable table table-hover table-bordered">
        <thead>
            <tr>
                <th>User</th>
                <th>Pages</th>
                <th>No of Pages</th>
            </tr>
        </thead>
        <tbody>
            {% for users in validate %}
            <tr>
                <td>
                    <a href="https://{{data["project"]}}.wikisource.org/wiki/User:{{users}}">
                        {{users}}
                    </a>
                </td>
                <td>
                    <p class="user-pages"> Show/Hide Pages </p>
                    <div style="display:none;">
                        {% for page in validate[users] %}
                            <a href="https://{{ data["project"] }}.wikisource.org/wiki/{{page}}">
                                {{page}}
                            </a>
                            <br>
                        {% endfor %}
                    </div>
                </td>
                <td>{{ validate[users]|length }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}